<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <title>ğŸŒ¿ NDVI & Soil Moisture Viewer (Serverless)</title>
    <style>
      body {
        font-family: sans-serif;
        margin: 0;
        padding: 0;
        text-align: center;
      }
      #controls {
        padding: 10px;
      }
      button {
        margin: 5px;
        padding: 8px 12px;
        font-size: 14px;
      }
      pre {
        text-align: left;
        margin: auto;
        background: #f4f4f4;
        padding: 10px;
        width: 90%;
        overflow-x: auto;
        white-space: pre-wrap;
      }
    </style>
  </head>
  <body>
    <h1>ğŸŒ¿ NDVI Viewer (via Netlify Functions)</h1>

    <div id="controls">
      <button onclick="fetchEE()">ğŸ” ØªØ³Øª Earth Engine</button>
      <pre id="result">â¬‡ï¸ Ù†ØªÛŒØ¬Ù‡ Ø§ÛŒÙ†Ø¬Ø§ Ù†Ù…Ø§ÛŒØ´ Ø¯Ø§Ø¯Ù‡ Ù…ÛŒâ€ŒØ´ÙˆØ¯...</pre>
    </div>

    <script>
      function fetchEE() {
        const resultEl = document.getElementById("result");
        resultEl.textContent = "â³ Ø¯Ø± Ø­Ø§Ù„ Ø§ØªØµØ§Ù„ Ø¨Ù‡ Earth Engine...";

        fetch("/.netlify/functions/ee-token")
          .then((res) => res.json())
          .then((data) => {
            if (data.success) {
              resultEl.textContent = "âœ… Ø§Ø±ØªØ¨Ø§Ø· Ø¨Ø§ Earth Engine Ø¨Ø±Ù‚Ø±Ø§Ø± Ø´Ø¯:\n\n" + JSON.stringify(data.info, null, 2);
            } else {
              resultEl.textContent = "âš ï¸ Ø®Ø·Ø§ Ø§Ø² Ø³Ù…Øª Ø³Ø±ÙˆØ±:\n\n" + JSON.stringify(data.error || data, null, 2);
            }
          })
          .catch((err) => {
            console.error("âŒ Ø®Ø·Ø§ Ø¯Ø± Ø§ØªØµØ§Ù„:", err);
            resultEl.textContent = "âŒ Ø®Ø·Ø§ Ø¯Ø± Ø¨Ø±Ù‚Ø±Ø§Ø±ÛŒ Ø§Ø±ØªØ¨Ø§Ø· ÛŒØ§ Ø¯Ø±ÛŒØ§ÙØª Ù¾Ø§Ø³Ø® Ø§Ø² ÙØ§Ù†Ú©Ø´Ù†.";
          });
      }
    </script>
  </body>
</html>
